{"title":"chokidar API","date":"2019-03-30T05:15:01.614Z","link":"post/chokidar","tags":["docs, npm"],"updated":"2019-08-04T11:49:51.943Z","content":"<p>github地址：<a href=\"https://github.com/paulmillr/chokidar\" target=\"_blank\" rel=\"noopener\">https://github.com/paulmillr/chokidar</a></p>\n<h1 id=\"chokidar-API\">chokidar API<a href=\"post/chokidar#chokidar-API\"></a></h1><h2 id=\"chokidar-watch-paths-options\">chokidar.watch(paths, [options])**<a href=\"post/chokidar#chokidar-watch-paths-options\"></a></h2><p>返回一个chokidar构造监听实例</p>\n<h3 id=\"参数：\">参数：<a href=\"post/chokidar#参数：\"></a></h3><h4 id=\"paths\">paths<a href=\"post/chokidar#paths\"></a></h4><p>一个字符串或者是一个数组，描述监听的文件或者文件夹的路径</p>\n<h4 id=\"配置对象数据类型\">配置对象数据类型<a href=\"post/chokidar#配置对象数据类型\"></a></h4><p>常用配置项：</p>\n<ul>\n<li><strong>persistent:bollean</strong>,与原生fs.watch一样,表示是否保护进程不退出持久监听，默认值为true</li>\n<li><strong>ignored:string</strong>,所要忽略监听的文件或者文件夹</li>\n<li><strong>ignoreInitial:bollean</strong>,表示是否<strong>忽略</strong>对增加文件或者增加文件夹的时候进行发送事件，默认值为false表示add/addDir会触发事件</li>\n<li><strong>cwd:string</strong>类型，没有默认值，类似于appBasepath，监听的paths所相对的路径。</li>\n<li><strong>usePolling:bollean</strong>，表示是否使用前面提到的fs.watchFile()进行轮询操作，由于轮询会导致cpu飙升，所以此选项通常在需要通过网络监视文件的时候才设置为true即使用fs.watchFile()，默认值为false</li>\n<li><strong>depth:number</strong>类型,没有默认值，如果设定则表示限定了会递归监听多少个子目录。</li>\n</ul>\n<h3 id=\"返回监听实例-FSWatcher-API\">返回监听实例 FSWatcher API<a href=\"post/chokidar#返回监听实例-FSWatcher-API\"></a></h3><h4 id=\"on-eventName-path-event-gt\">on(eventName,(path, event) =&gt; {})<a href=\"post/chokidar#on-eventName-path-event-gt\"></a></h4><h4 id=\"add-path-paths\">.add(path / paths):<a href=\"post/chokidar#add-path-paths\"></a></h4><p>添加文件，目录或glob模式以进行跟踪。<br>支持字符串数组或单独字符串路径</p>\n<h4 id=\"on-event-callback\">.on(event, callback):<a href=\"post/chokidar#on-event-callback\"></a></h4><p>监听支持的事件</p>\n<p><strong>支持的事件名eventName</strong></p>\n<ul>\n<li>add    新增文件时触发</li>\n<li>addDir    新增文件夹的时候触发</li>\n<li>unlink    对应的文件的删除</li>\n<li>unlinkDir    对应的文件夹的删除</li>\n<li>change    文件内容改变时触发</li>\n<li>all 指代以上所有事件（除了ready, raw, and error之外所有的事件类型）</li>\n<li>ready</li>\n<li>raw</li>\n<li>error 捕获error</li>\n</ul>\n<p><strong>callback (path, event) =&gt; {}</strong><br>path 指代监听到的文件/文件夹路径</p>\n<h4 id=\"unwatch-path-paths\">.unwatch(path / paths):<a href=\"post/chokidar#unwatch-path-paths\"></a></h4><p>停止监听传入文件/文件夹</p>\n<h4 id=\"close\">.close():<a href=\"post/chokidar#close\"></a></h4><p>从监视文件中移除/关闭所有侦听器</p>\n<h4 id=\"getWatched\">.getWatched():<a href=\"post/chokidar#getWatched\"></a></h4><p>返回此FSWatcher实例正在监视的文件系统上所有路径的对象，<br>对象的键是所有目录（使用绝对路径，除非使用了cwd选项），并且值是每个目录中包含的项的名称的数组。</p>\n<h2 id=\"代码示例\">代码示例<a href=\"post/chokidar#代码示例\"></a></h2><figure class=\"highlight plain\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const chokidar = require(&apos;chokidar&apos;)</span><br><span class=\"line\"></span><br><span class=\"line\">chokidar.watch(&apos;testFolder&apos;, &#123;</span><br><span class=\"line\">  persistent: true,</span><br><span class=\"line\">  ignored: /(^|[\\/\\\\])\\../, // 忽略点文件</span><br><span class=\"line\">  cwd: &apos;.&apos;, // 表示当前目录</span><br><span class=\"line\">  depth:0 // 只监听当前目录不包括子目录</span><br><span class=\"line\">&#125;).on(&apos;all&apos;, (event, path) =&gt; &#123;//监听除了ready, raw, and error之外所有的事件类型</span><br><span class=\"line\">  console.log(event, path);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></div></figure>\n\n","prev":{"title":"《css世界》书摘","link":"post/css世界"},"next":{"title":"node中获取正在运行的全部进程数据","link":"post/node2"},"plink":"https://yanoo1497.github.io/post/chokidar/","toc":[{"title":"chokidar API","id":"chokidar-API","index":"1","children":[{"title":"chokidar.watch(paths, [options])**","id":"chokidar-watch-paths-options","index":"1.1","children":[{"title":"参数：","id":"参数：","index":"1.1.1"},{"title":"返回监听实例 FSWatcher API","id":"返回监听实例-FSWatcher-API","index":"1.1.2"}]},{"title":"代码示例","id":"代码示例","index":"1.2"}]}]}