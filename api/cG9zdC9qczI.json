{"title":"跨浏览器的javascript中鼠标滚轮事件","date":"2019-03-30T05:15:01.583Z","link":"post/js2","tags":["javascript"],"categories":["javascript"],"updated":"2019-08-04T14:16:55.113Z","content":"<p>参考：<br><a href=\"http://www.jb51.net/article/66710.htm\" target=\"_blank\" rel=\"noopener\">解析javascript中鼠标滚轮事件</a></p>\n<p><a href=\"http://www.zhangxinxu.com/wordpress/2013/04/js-mousewheel-dommousescroll-event/\" target=\"_blank\" rel=\"noopener\">JS滚轮事件(mousewheel/DOMMouseScroll)了解</a></p>\n<h5 id=\"1-事件绑定\">1.事件绑定<a href=\"post/js2#1-事件绑定\"></a></h5><p>Firefox使用addEventListener添加滚轮事件</p>\n<figure class=\"highlight js\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*Firefox注册事件*/</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"built_in\">document</span>.addEventListener)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">document</span>.addEventListener(<span class=\"string\">'DOMMouseScroll'</span>,scrollFunc,<span class=\"literal\">false</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n<p>其中除Firefox外其余均可使用HTML DOM方式添加事件，因此添加事件使用以下方式</p>\n<figure class=\"highlight js\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*注册事件*/</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"built_in\">document</span>.addEventListener)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">document</span>.addEventListener(<span class=\"string\">'DOMMouseScroll'</span>,scrollFunc,<span class=\"literal\">false</span>);</span><br><span class=\"line\">&#125;<span class=\"comment\">//W3C</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.onmousewheel=<span class=\"built_in\">document</span>.onmousewheel=scrollFunc;<span class=\"comment\">//IE/Opera/Chrome</span></span><br></pre></td></tr></table></div></figure>\n\n<h5 id=\"detail与wheelDelta\">detail与wheelDelta<a href=\"post/js2#detail与wheelDelta\"></a></h5><p>判断滚轮向上或向下的属性值，现在五大浏览器（IE、Opera、Safari、Firefox、Chrome）中Firefox 使用detail，其余四类使用wheelDelta；两者只在取值上不一致，代表含义一致，detail与wheelDelta只各取两个值，detail只取±3，wheelDelta只取±120，其中FireFox浏览器向下滚动是正值，而其他浏览器是负值。</p>\n<h5 id=\"兼容写法\">兼容写法<a href=\"post/js2#兼容写法\"></a></h5><figure class=\"highlight js\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 简易的判断滚动方向</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> scrollFunc=<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">e</span>)</span>&#123;</span><br><span class=\"line\">     <span class=\"keyword\">var</span> direct=<span class=\"number\">0</span>;</span><br><span class=\"line\">     e=e || <span class=\"built_in\">window</span>.event;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> flag;</span><br><span class=\"line\">     <span class=\"keyword\">if</span>(e.wheelDelta)&#123;<span class=\"comment\">//IE/Opera/Chrome</span></span><br><span class=\"line\">         <span class=\"keyword\">if</span>(e.wheelDelta&gt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">             flag=<span class=\"string\">\"up\"</span>;</span><br><span class=\"line\">         &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">              flag=<span class=\"string\">\"down\"</span>;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">     &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(e.detail)&#123;<span class=\"comment\">//Firefox</span></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"><span class=\"comment\">/*注册事件*/</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"built_in\">document</span>.addEventListener)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">document</span>.addEventListener(<span class=\"string\">'DOMMouseScroll'</span>,scrollFunc,<span class=\"literal\">false</span>);</span><br><span class=\"line\">&#125;<span class=\"comment\">//W3C</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.onmousewheel=<span class=\"built_in\">document</span>.onmousewheel=scrollFunc;<span class=\"comment\">//IE/Opera/Chrome/Safari</span></span><br></pre></td></tr></table></div></figure>\n\n","prev":{"title":"常用js页面跳转方式","link":"post/js3"},"next":{"title":"sass学习笔记","link":"post/sass学习笔记"},"plink":"https://yanoo1497.github.io/post/js2/"}